!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.tusk=e()}}(function(){return function e(t,n,i){function r(s,l){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[s]={exports:{}};t[s][0].call(h.exports,function(e){var n=t[s][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){t.exports={NODE:"__node__",NAMESPACES:{HTML:"http://www.w3.org/1999/xhtml",MATH_ML:"http://www.w3.org/1998/Math/MathML",SVG:"http://www.w3.org/2000/svg"},SELF_CLOSING:["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],EVENTS:["animationend","animationiteration","animationstart","beforeunload","blur","canplay","canplaythrough","change","click","contextmenu","copy","cut","dblclick","drag","dragend","dragenter","dragexit","dragleave","dragover","dragstart","drop","durationchange","emptied","ended","focus","fullscreenchange","input","keydown","keypress","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","paste","pause","play","playing","progress","ratechange","reset","scroll","seeked","seeking","select","stalled","submit","suspend","timeupdate","touchcancel","touchend","touchmove","touchstart","transitionend","visibilitychange","volumechange","waiting","wheel"]}},{}],2:[function(e,t,n){var i,r,o,s;s=e("./constants"),r=s.NODE,i=s.EVENTS,o=function(e){var t,n,i,o,s,l;if(s=e.target,l=e.type,l=l.toLowerCase(),e.bubbles)for(e.stopPropagation=function(){return e.cancelBubble=!0},Object.defineProperty(e,"currentTarget",{value:s,writable:!0});s&&(e.currentTarget=s,i=s[r],s=s.parentNode,null!=i&&"function"==typeof(n=i.events)[l]&&n[l](e),!e.cancelBubble););else null!=(o=s[r])&&"function"==typeof(t=o.events)[l]&&t[l](e)},t.exports={dispatch:function(e,t,n){var i;null==n&&(n=!1),i=document.createEvent("Event"),i.initEvent(e,n,!1),Object.defineProperties(i,{target:{value:t},srcElement:{value:t}}),o(i)},init:function(){var e,t,n;if(!document.__tusk){for(e=0,t=i.length;t>e;e++)n=i[e],document.addEventListener(n,o,!0);document.__tusk=!0}}}},{"./constants":1}],3:[function(e,t,n){var i,r,o,s,l,a,u,h;r=e("./virtual/node"),i=e("./constants").NODE,a=e("./util"),s=a.flattenInto,l=a.getDiff,o=e("./delegator"),u=void 0,h=function(e,t){var n,i,o;for(i=Math.max(arguments.length-2,0),n=new Array(i);i--;)n[i]=arguments[i+2];switch(n=s(n,[]),typeof e){case"string":return new r(e,t,n);case"function":return o=e(t,n,u),(null!=o?o.constructor:void 0)===r&&(o.owner=e),o;default:throw new TypeError("Tusk: Invalid virtual node type.")}},h.createElement=h,h.render=function(e,t){var n,r,s,a,u,h;if("undefined"==typeof window)throw new Error("Tusk: Cannot render on the server (use toString).");if(!(e instanceof window.Node))throw new Error("Tusk: Container must be a DOM element.");if(!(null!=t?t.isTusk:void 0))throw new Error("Tusk: Can only render a virtual node.");(null!=(a=e[i])?a.update(t):void 0)||(s=e.outerHTML,r=t.toString(),r===s?t.mount(e):(e.parentNode.replaceChild(t.create(),e),null!=s&&(u=l(s,r),h=u[0],n=u[1],console.warn("Tusk: Could not bootstrap document, existing html and virtual html do not match.\n\nServer:\n"+h+"\n\nClient:\n"+n))),o.init())},h["with"]=function(e,t){var n;return u=e,n="function"==typeof t?t():void 0,u=void 0,n},t.exports=h},{"./constants":1,"./delegator":2,"./util":4,"./virtual/node":5}],4:[function(e,t,n){var i;t.exports={escapeHTML:function(e){return String(e).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},flattenInto:i=function(e,t){var n,r,o;for(r=0,o=e.length;o>r;r++)n=e[r],n instanceof Array?i(n,t):t.push(n);return t},getDiff:function(e,t){var n,i,r,o,s,l;for(r=o=0,s=e.length;s>o&&(n=e[r],n===t[r]);r=++o);return l=Math.max(0,r-20),i=l+80,[e.slice(l,Math.min(i,e.length)),t.slice(l,Math.min(i,t.length))]},setAttrs:function(e,t,n){var i,r;if(t!==n){for(i in n)r=n[i],null!=r&&r!==t[i]&&e.setAttribute(i,r);for(i in t)!i in n&&e.removeAttribute(i)}},setChildren:function(e,t,n){var i,r,o;if(t!==n){for(r in n){if(i=n[r],r in t){if((o=t[r]).update(i),o.index===i.index)continue}else i.create();e.insertBefore(i._elem,e.childNodes[i.index])}for(r in t)i=t[r],r in n||i.remove()}}}},{}],5:[function(e,t,n){var i,r,o,s,l,a,u,h,c,d,f,p,m=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};c=e("../constants"),s=c.SELF_CLOSING,r=c.NODE,i=c.NAMESPACES,d=e("../util"),u=d.escapeHTML,f=d.setAttrs,p=d.setChildren,a=e("../delegator").dispatch,l=e("./text"),h=function(e,t,n,i){var r,o,s,a;if(null==e&&(e=" "),e.constructor===Array)for(o=s=0,a=e.length;a>s;o=++s)r=e[o],h(r,t,n,i+o);else e.isTusk||(e=new l(e)),e.index=i,null==e.namespaceURI&&(e.namespaceURI=t),n[e.key||i]=e;return n},o=function(e,t,n){var r,o,l;if(this.type=e,this.namespaceURI="svg"===this.type?i.SVG:"math"===this.type?i.MATH_ML:void 0,this.attrs={},this.events={},this.children={},null!=t){this.key=t.key,delete t.key,this.innerHTML=t.innerHTML,delete t.innerHTML;for(r in t)l=t[r],"on"!==r.slice(0,2)?this.attrs[r]=l:this.events[r.slice(2).toLowerCase()]=l}null!=this.innerHTML||(o=this.type,m.call(s,o)>=0)||h(n,this.namespaceURI,this.children,0)},o.prototype.isTusk=!0,o.prototype.mount=function(e){var t,n,i,o;if(this._elem=(n=e.childNodes,e),e[r]=this,null==this.innerHTML){o=this.children;for(i in o)t=o[i],t.mount(n[t.index||i])}a("mount",e)},o.prototype.create=function(){var e,t,n,o;return n=null!=this._elem?this._elem:this._elem=document.createElementNS(this.namespaceURI||i.HTML,this.type),o=n[r],n[r]=this,o?(e=o.attrs,t=o.children):e=t={},f(n,e,this.attrs),null!=this.innerHTML?n.innerHTML=this.innerHTML:p(n,t,this.children),a("mount",n),n},o.prototype.update=function(e){var t;if(this===e)return this;if(this.type!==e.type)this._elem.parentNode.insertBefore(e.create(),this._elem),this.remove();else{if(t=this.owner!==e.owner,t&&a("dismount",this._elem),this._elem[r]=e,e._elem=this._elem,f(this._elem,this.attrs,e.attrs),null!=e.innerHTML)this.innerHTML!==e.innerHTML&&(this._elem.innerHTML=e.innerHTML);else{if(null!=this.innerHTML)for(;this._elem.firstChild;)this._elem.removeChild(this._elem.firstChild);p(this._elem,this.children,e.children)}t&&a("mount",this._elem)}return e},o.prototype.remove=function(){var e,t,n;a("dismount",this._elem),n=this.children;for(t in n)e=n[t],e.remove();return this._elem.parentNode.removeChild(this._elem)},o.prototype.toString=function(){var e,t,n,i,r,o,l,a;e=n="",r=this.attrs;for(i in r)a=r[i],e+=" "+i+'="'+u(a)+'"';if(null!=this.innerHTML)n=this.innerHTML;else{o=this.children;for(i in o)t=o[i],n+=t}return l=this.type,m.call(s,l)>=0?"<"+(this.type+e)+">":"<"+(this.type+e)+">"+n+"</"+this.type+">"},t.exports=o},{"../constants":1,"../delegator":2,"../util":4,"./text":6}],6:[function(e,t,n){var i,r;r=e("../util").escapeHTML,i=function(e){this.value=String(e)},i.prototype.isTusk=!0,i.prototype.mount=function(e){var t;this._elem=(t=e.nodeValue,e),this.value!==t&&e.splitText(t.indexOf(this.value)+this.value.length)},i.prototype.create=function(){return null==this._elem&&(this._elem=document.createTextNode(this.value)),this._elem.nodeValue!==this.value&&(this._elem.nodeValue=this.value),this._elem},i.prototype.update=function(e){return this===e?this:(e.constructor===i?(e._elem=this._elem,this.value!==e.value&&(this._elem.nodeValue=e.value)):this._elem.parentNode.replaceChild(e.create(),this._elem),e)},i.prototype.remove=function(){return this._elem.parentNode.removeChild(this._elem)},i.prototype.toString=function(){return r(this.value)},t.exports=i},{"../util":4}]},{},[3])(3)});